## Batch Connect app configuration file
##
## @note Used to define the submitted cluster, title, description, and
##   hard-coded/user-defined attributes that make up this Batch Connect app.
#---
#
## **MUST** set cluster id here that matches cluster configuration file located
## under /etc/ood/config/clusters.d/*.yml
## @example Use the Owens cluster at Ohio Supercomputer Center
##     cluster: "owens"
#cluster: "odyssey3"
#
## Define attribute values that aren't meant to be modified by the user within
## the Dashboard form
#attributes:
#  # Set the corresponding modules that need to be loaded for Jupyter to run
#  #
#  # @note It is called within the batch job as `module load <modules>` if
#  #   defined
#  # @example Do not load any modules
#  #     modules: ""
#  # @example Using default python module
#  #     modules: "python"
#  # @example Using specific python module
#  #     modules: "python/3.5"
#  # @example Using combination of modules
#  #     modules: "python/3.5 cuda/8.0.44"
#  modules: ""
#
## All of the attributes that make up the Dashboard form (in respective order),
## and made available to the submit configuration file and the template ERB
## files
##
## @note You typically do not need to modify this unless you want to add a new
##   configurable value
## @note If an attribute listed below is hard-coded above in the `attributes`
##   option, then it will not appear in the form page that the user sees in the
##   Dashboard
#form:
#  - modules
#  - bc_account
#  - bc_queue
#  - bc_num_hours
#  - bc_num_slots
#  - bc_email_on_started
#
---
name: CryoSPARC
cluster: "odyssey3"
attributes:
  modules: null
  config_file:
    label: "Path to CryoSPARC config file (config.sh)."
    widget: text_field
  binary_directory:
    label: "Where'd you install the cryosparcm binary?"
    widget: text_field
  custom_time:
    label: "Allocated Time (expressed in MM , or HH:MM:SS , or DD-HH:MM)."
    value: "<%= defined?(@custom_time) ? @custom_time : '04:00:00' %>"
    widget: text_field
  bc_queue: "test"
  custom_email_address:
    label: "email address for status notification"
    widget: text_field
  custom_memory_per_node:
    label: "Memory Allocation in GB"
    value: <%= defined?(@custom_memory_per_node) ? @custom_memory_per_node : 32 %>
    min: <%= defined?(@custom_memory_per_node_min) ? @custom_memory_per_node_min : 1 %>
    step: 1
    max: <%= defined?(@custom_memory_per_node_max) ? @custom_memory_per_node_max : 32 %>
    widget: number_field
  custom_num_cores:
    label: "Number of cores"
    value: <%= defined?(@custom_num_cores) ? @custom_num_cores : 4 %>
    min: <%= defined?(@custom_num_cores_min) ? @custom_num_cores_min : 1 %>
    step: 1
    max: <%= defined?(@custom_num_cores_max) ? @custom_num_cores_max : 16 %>
    widget: number_field
    help: "Number of Cpus to allocate"
  custom_num_gpus: <%= defined?(@custom_num_gpus) ? @custom_num_gpus : 0 %> 
  custom_reservation: null
  envscript: null
  bc_account:
    label: "Slurm Account"
    help: "If you are not in multiple labs please leave this blank."

form:
  - config_file
  - modules
  - bc_queue
  - custom_memory_per_node
  - custom_num_cores
  - custom_num_gpus
  - custom_time
  - envscript
  - custom_reservation
